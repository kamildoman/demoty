{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\login\\\\Documents\\\\python\\\\demotywatory\\\\demoty\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import Demot from\"./Demot\";import Navbar from'./Navbar';import Pagination from'./Pagination';import SinglePageDemot from\"./SinglePageDemot\";import'./App.css';import{BrowserRouter as Router,Routes,Route}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),demots=_useState2[0],setDemots=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState(5),_useState8=_slicedToArray(_useState7,1),postsPerPage=_useState8[0];var getToken=function getToken(){var header={'Authorization':'Token '+localStorage.getItem('LoginToken')};axios.get('/user/',{headers:header}).then(function(res){var username=res.data.username.substring(0,10);setUsername(username);}).catch(function(e){if(e.response.status>300){setUsername(\"Anonymous\");}});};var refreshList=function refreshList(){axios.get('/api/demots/').then(function(response){setDemots(response.data.reverse());});setTimeout(function(){getToken();},1000);};useEffect(function(){refreshList();getToken();},[]);var indexOfLastPost=currentPage*postsPerPage;var indexOfFirstPost=indexOfLastPost-postsPerPage;var currentPosts=demots.slice(indexOfFirstPost,indexOfLastPost);function paginate(pageNumber){setCurrentPage(pageNumber);}return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{setCurrentPage:setCurrentPage,refresh:refreshList,username:username}),/*#__PURE__*/_jsx(\"div\",{className:\"main\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,element:/*#__PURE__*/_jsxs(_Fragment,{children:[currentPosts.map(function(demot){return/*#__PURE__*/_jsx(Demot,{id:demot.id,whole:true,title:demot.title,subtitle:demot.subtitle,image:demot.image,upvote:demot.upvote,downvote:demot.downvote,ips:demot.ips,owner:demot.owner},demot.id);}),/*#__PURE__*/_jsx(Pagination,{postsPerPage:postsPerPage,totalPosts:demots.length,paginate:paginate})]})}),/*#__PURE__*/_jsx(Route,{path:\"/demot/:id\",element:/*#__PURE__*/_jsx(SinglePageDemot,{})})]})})]})});}export default App;","map":{"version":3,"sources":["C:/Users/login/Documents/python/demotywatory/demoty/src/App.js"],"names":["React","useState","useEffect","axios","Demot","Navbar","Pagination","SinglePageDemot","BrowserRouter","Router","Routes","Route","App","demots","setDemots","username","setUsername","currentPage","setCurrentPage","postsPerPage","getToken","header","localStorage","getItem","get","headers","then","res","data","substring","catch","e","response","status","refreshList","reverse","setTimeout","indexOfLastPost","indexOfFirstPost","currentPosts","slice","paginate","pageNumber","map","demot","id","title","subtitle","image","upvote","downvote","ips","owner","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Demot from \"./Demot\"\nimport Navbar from './Navbar'\nimport Pagination from './Pagination'\nimport SinglePageDemot from \"./SinglePageDemot\";\nimport './App.css';\nimport {\n  BrowserRouter as Router,\n  Routes,\n  Route,\n} from \"react-router-dom\";\n\n\n\n\nfunction App() {\n  const [demots, setDemots] = useState([])\n  const [username, setUsername] = useState(\"\")\n  const [currentPage, setCurrentPage] = useState(1)\n  const [postsPerPage] = useState(5)\n\n  const getToken = () => {\n    let header = {\n      'Authorization': 'Token ' + localStorage.getItem('LoginToken')}\n\n      axios.get('/user/', {headers: header,\n      }).then(res => {\n        let username = res.data.username.substring(0, 10)\n        setUsername(username)\n      }).catch(e => {\n        if (e.response.status > 300){\n            setUsername(\"Anonymous\")\n        }\n    })\n    }\n\n  const refreshList = () => {\n      axios.get('/api/demots/')\n      .then(function (response) {\n        setDemots(response.data.reverse()) \n      })\n      setTimeout(function() { getToken(); }, 1000);\n    };\n\n    useEffect(() => {\n      refreshList()\n      getToken()\n    }, [])\n    \n    const indexOfLastPost = currentPage * postsPerPage\n    const indexOfFirstPost = indexOfLastPost - postsPerPage\n    const currentPosts = demots.slice(indexOfFirstPost, indexOfLastPost)\n\n    function paginate(pageNumber){\n      setCurrentPage(pageNumber)\n    }\n\n    return (<Router><div>\n              <Navbar setCurrentPage={setCurrentPage} refresh={refreshList} username={username}/>\n              <div className=\"main\">\n              <Routes>\n              <Route path=\"/\" exact element= {<>{currentPosts.map(demot =>(\n              <Demot\n              key= {demot.id} \n              id = {demot.id}\n              whole = {true}\n              title={demot.title}\n              subtitle={demot.subtitle}  \n              image={demot.image}\n              upvote={demot.upvote}\n              downvote={demot.downvote}\n              ips={demot.ips}\n              owner={demot.owner}\n              />\n            ))}<Pagination \n            postsPerPage={postsPerPage} \n            totalPosts={demots.length} \n            paginate={paginate}  \n            /></>} />\n\n            <Route path=\"/demot/:id\" element={<SinglePageDemot />} />\n            </Routes>\n            \n            </div>\n           \n            </div></Router>)\n    \n  }\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}