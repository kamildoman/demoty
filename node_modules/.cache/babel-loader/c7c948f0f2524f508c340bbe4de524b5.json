{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\login\\\\Documents\\\\python\\\\demotywatory\\\\demoty\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\login\\\\Documents\\\\python\\\\demotywatory\\\\demoty\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\login\\\\Documents\\\\python\\\\demotywatory\\\\demoty\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from'react';import{useParams}from'react-router-dom';import axios from\"axios\";import Demot from'./Demot';import SingleComment from'./SingleComment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SinglePageDemot=function SinglePageDemot(){var _useParams=useParams(),id=_useParams.id;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),demot=_useState2[0],setDemot=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),doesExist=_useState6[0],setDoesExist=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),commentValue=_useState8[0],setCommentValue=_useState8[1];function handleCommentChange(event){setCommentValue(event.target.value);}function addComment(){var formData=new FormData();formData.append(\"comment_text\",commentValue);formData.append(\"demot\",id);setCommentValue(\"\");axios.post('/api/comments/',formData);setTimeout(getComments,1000);}function getComments(){var results=[];axios.get('/api/comments/').then(function(response){response.data.forEach(function(comment){if(comment.demot===Number(id)){results.push(comment);}});setComments(results.reverse());});}useEffect(function(){function getData(){return _getData.apply(this,arguments);}function _getData(){_getData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:axios.get('/api/demots/'+id+'/').then(function(response){setDemot(response===null||response===void 0?void 0:response.data);}).catch(function(e){if(e.response.status===404){setDoesExist(false);}});case 1:case\"end\":return _context.stop();}}},_callee);}));return _getData.apply(this,arguments);}getData();getComments();},[id]);if(doesExist){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Demot,{id:demot.id,whole:true,title:demot.title,subtitle:demot.subtitle,image:demot.image,upvote:demot.upvote,downvote:demot.downvote,ips:demot.ips},demot.id),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{id:\"comments-input\",onChange:handleCommentChange,value:commentValue,placeholder:\"Add a comment...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:addComment,className:\"comments-button\",children:\"Post\"})]}),comments.map(function(comment){return/*#__PURE__*/_jsx(SingleComment,{text:comment.comment_text,date:comment.date},comment.id);})]});}else{return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Sorry, it doesn't exist\"})});}};export default SinglePageDemot;","map":{"version":3,"sources":["C:/Users/login/Documents/python/demotywatory/demoty/src/SinglePageDemot.jsx"],"names":["React","useState","useEffect","useParams","axios","Demot","SingleComment","SinglePageDemot","id","demot","setDemot","comments","setComments","doesExist","setDoesExist","commentValue","setCommentValue","handleCommentChange","event","target","value","addComment","formData","FormData","append","post","setTimeout","getComments","results","get","then","response","data","forEach","comment","Number","push","reverse","getData","catch","e","status","title","subtitle","image","upvote","downvote","ips","map","comment_text","date"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport {useParams} from 'react-router-dom';\r\nimport axios from \"axios\";\r\nimport Demot from './Demot';\r\nimport SingleComment from './SingleComment';\r\n\r\nconst SinglePageDemot = () => {\r\n    const {id} = useParams();\r\n    const [demot, setDemot] = useState(\"\")\r\n    const [comments, setComments] = useState([])\r\n    const [doesExist, setDoesExist] = useState(true)\r\n    const [commentValue, setCommentValue] = useState(\"\")\r\n\r\n    function handleCommentChange(event){\r\n        setCommentValue(event.target.value)\r\n    }\r\n\r\n    function addComment(){\r\n        var formData = new FormData();\r\n        formData.append(\"comment_text\", commentValue);\r\n        formData.append(\"demot\", id);\r\n        setCommentValue(\"\")\r\n        \r\n        axios.post('/api/comments/', formData)\r\n        setTimeout(getComments, 1000)\r\n    }\r\n\r\n    function getComments(){\r\n        let results = []\r\n        axios.get('/api/comments/')\r\n        .then(function(response){\r\n            response.data.forEach(comment => {\r\n                if (comment.demot === Number(id)){\r\n                    results.push(comment)\r\n                }\r\n            })\r\n            setComments(results.reverse())\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        async function getData(){\r\n            axios.get('/api/demots/' + id +'/')\r\n            .then(function (response) {\r\n                    setDemot(response?.data) \r\n            })\r\n            .catch(e => {\r\n                if (e.response.status === 404){\r\n                    setDoesExist(false)\r\n                }\r\n            })\r\n        }\r\n       \r\n\r\n        getData();\r\n        getComments();\r\n        \r\n      }, [id])\r\n      if (doesExist){\r\n        return (\r\n            <div>\r\n                <Demot\r\n                  key= {demot.id} \r\n                  id = {demot.id}\r\n                  whole = {true}\r\n                  title={demot.title}\r\n                  subtitle={demot.subtitle}  \r\n                  image={demot.image}\r\n                  upvote={demot.upvote}\r\n                  downvote={demot.downvote}\r\n                  ips={demot.ips}\r\n                  />\r\n                  <div>\r\n                    <input \r\n                    id=\"comments-input\" onChange={handleCommentChange} value={commentValue} placeholder=\"Add a comment...\" />\r\n                    <button type=\"submit\" onClick={addComment}     \r\n                    className=\"comments-button\">Post</button>\r\n                </div>\r\n                  {comments.map(comment => (\r\n                      <SingleComment \r\n                          key={comment.id}\r\n                          text={comment.comment_text}\r\n                          date={comment.date}\r\n                      />\r\n                  ))}\r\n            </div>\r\n        )\r\n      }\r\n      else {\r\n          return <div><h2>Sorry, it doesn't exist</h2></div>\r\n      }\r\n    \r\n}\r\n\r\nexport default SinglePageDemot\r\n"]},"metadata":{},"sourceType":"module"}